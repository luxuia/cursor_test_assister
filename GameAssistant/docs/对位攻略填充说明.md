# 英雄对位攻略：遍历与填充说明

## 一、数据位置与格式

- **文件**：`Data/HeroMatchupGuides.json`
- **结构**：`matchups` 数组，每项为「我方英雄 vs 敌方英雄」一条攻略。

```json
{
  "matchups": [
    {
      "ourHeroId": "disruptor",
      "ourHeroNameCn": "干扰者",
      "versusHeroId": "shadow_shaman",
      "versusHeroNameCn": "暗影萨满",
      "itemBuild": "出装建议文本",
      "skillBuild": "技能加点建议文本",
      "tips": "对线/团战要点"
    }
  ]
}
```

- **英雄 ID**：与 `Data/Dota2Heroes_FromWeb.json` 中 `heroes[].id` 一致（小写、下划线），如 `disruptor`、`shadow_shaman`、`phantom_assassin`。

## 二、何时会触发对位建议

1. **GameState** 中同时具备：
   - **HeroRoster**：己方识别到的英雄 ID 列表；
   - **EnemyHeroes**：敌方/对位英雄 ID 列表。
2. 若当前未识别敌方，`GameState.EnemyHeroes` 为空，对位攻略不会加入建议列表。
3. 识别到「己方有 A、敌方有 B」且 `HeroMatchupGuides.json` 中存在 `ourHeroId=A`、`versusHeroId=B` 时，会追加一条对位建议（出装 + 技能 + 要点）。

## 三、如何「遍历所有英雄」填充对位

### 方式 1：手动按对位补充（推荐先做）

- 打开 `Data/HeroMatchupGuides.json`，在 `matchups` 里追加新对象。
- 英雄 ID 从 `Data/Dota2Heroes_FromWeb.json` 的 `heroes[].id` 和 `nameCn` 对照填写。
- 出装、加点、要点可从以下来源整理：
  - [Dota2Counters](https://dota2counters.com/)：各英雄 Counter 页
  - [Dotabuff](https://www.dotabuff.com/heroes)：英雄 Counters
  - [Dotacoach](https://dotacoach.gg/)：英雄克制与搭配
  - 中文攻略站：17173、完美世界 APP、贴吧等「XX 对位 YY」攻略

### 方式 2：用本项目的生成器打出全英雄对位空模板

- 使用 **Tools/MatchupGuideGenerator.cs**：调用 `MatchupGuideGenerator.GenerateFullTemplate()` 会读取 `Data/Dota2Heroes_FromWeb.json`，遍历所有英雄生成 (A, B) 对（A≠B），写出 **Data/HeroMatchupGuides_FullTemplate.json**（约 128×127 条），`itemBuild`/`skillBuild`/`tips` 为空。
- 在代码里临时加一行调用即可（例如在 `Program.Main` 或某个按钮/菜单里）：
  ```csharp
  GameAssistant.Tools.MatchupGuideGenerator.GenerateFullTemplate();
  ```
- 生成后可将「有内容的」条目从现有 `HeroMatchupGuides.json` 合并进模板，或把模板里需要填的对位复制到 `HeroMatchupGuides.json` 再逐条补充/爬取。

### 方式 3：批量爬取（需自行合规）

- 无通用公开 API 时，可对 dota2counters / dotabuff 等做定向抓取：
  - 遍历每个英雄页；
  - 解析「Countered by / Counters」表格或列表，得到 (hero, vs_hero)；
  - 再进入具体 matchup 或 build 子页抓取出装/加点/提示文本；
- 写入时仍按上述 JSON 结构，`ourHeroId` / `versusHeroId` 需映射到本地 `Dota2Heroes_FromWeb.json` 的 `id`（注意英文名与 id 的对应）。

## 四、规则中的对位条件（advice_rules.json）

- 若希望在「规则」里也按对位触发（而不只靠对位攻略 JSON），可在 `AdviceCondition` 中使用 **VersusHeroCombination**：
  - 表示「敌方存在其中至少一名英雄时该规则才触发」。
- 示例：己方有干扰者、敌方有暗影萨满时给一条固定提示：

```json
{
  "Condition": {
    "HeroCombination": ["disruptor"],
    "VersusHeroCombination": ["shadow_shaman"],
    "HealthThreshold": null,
    "Phase": null
  },
  "AdviceContent": "对位小y时注意保持距离，用雷霆之击消耗，等枷锁/妖术交完再进场放大。",
  "Priority": 7,
  "Type": 1
}
```

- 只有当前 `GameState.EnemyHeroes` 在构建条件时被填入，且与 `VersusHeroCombination` 有交集时，该规则才会命中。

## 五、小结

- **对位攻略内容**：全部放在 `Data/HeroMatchupGuides.json` 的 `matchups` 中，按 (己方英雄, 敌方英雄) 一条条补。
- **遍历所有英雄**：用脚本生成「所有 (A,B) 对」的占位条目，再逐条或批量补充出装/技能/要点；或从攻略站按对位抓取后映射到同一 JSON 结构。
- **触发条件**：依赖识别或配置提供 `GameState.EnemyHeroes`；未提供则对位建议不显示，规则中的 `VersusHeroCombination` 也不会生效。
